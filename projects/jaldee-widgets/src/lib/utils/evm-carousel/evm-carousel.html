<div 
  class="evm-carousel-wrapper"
  [class.center-mode]="config.center"
  role="listbox"
>

  <div
    class="evm-carousel-stage"
    #stage
    [style.transform]="getTransform()"
    [style.padding]="'0 ' + (config.stagePadding || 0) + 'px'"
    [style.transition]="transitionStyle"
    (pointerdown)="onPointerDown($event)"
    (pointermove)="onPointerMove($event)"
    (pointerup)="onPointerUp($event)"
    (pointercancel)="onPointerCancel($event)"
  >

    <div
      class="evm-carousel-item"
      *ngFor="let item of renderedItems; let idx = index"
      [attr.data-rendered-index]="idx"
      [style.flex]="getFlex()"
      [style.padding.px]="config.itemPadding ?? 0"
      [style.transform]="'scale(' + getItemScale(idx) + ')'"
      [style.opacity]="getItemScale(idx) === 1 ? 1 : 0.6"
      role="option"
      [attr.aria-selected]="currentIndex === idx"
    >
<ng-container
  *ngTemplateOutlet="userTemplate || defaultTemplate; context: {$implicit: item, index: idx}"
></ng-container>
    </div>

  </div>

  <div class="evm-carousel-nav" *ngIf="config.showNav">
    <button class="nav prev" (click)="prev()" aria-label="Previous slide">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M15 5l-6 7 6 7" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
    </button>
    <button class="nav next" (click)="next()" aria-label="Next slide">
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M9 5l6 7-6 7" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
    </button>
  </div>

  <div class="dots" *ngIf="config.showDots && !config.center">
    <span
      *ngFor="let item of items; let idx = index"
      [class.active]="idx === currentIndex"
      (click)="goTo(idx)"
    ></span>
  </div>

</div>
